<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Pre-Triaje</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0451BC',
                        secondary: '#6B7280',
                        light: '#F3F4F6',
                        danger: '#EF4444',
                        warning: '#F59E0B',
                        success: '#10B981',
                    },
                    fontFamily: {
                        sans: ['DM Sans', 'sans-serif'],
                    },
                }
            },
            darkMode: 'class',
        }
    </script>
    
</head>
<body class="bg-white dark:bg-gray-900 transition-colors duration-300">
    <div class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-white dark:bg-gray-800 shadow-sm py-4 px-6 flex justify-between items-center">
            <div class="flex items-center">
                <img src="Logo1.png" alt="Logo Sistema Pre-Triaje" class="header-logo">
                <h1 class="ml-2 text-xl font-bold text-primary dark:text-blue-400">Sistema de Pre-Triaje</h1>
            </div>
            <div class="flex items-center space-x-4">
                <button id="theme-toggle" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary dark:focus:ring-blue-400">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-600 dark:text-gray-300 hidden dark:block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-600 dark:text-gray-300 dark:hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                    </svg>
                </button>
                <button id="language-toggle" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary dark:focus:ring-blue-400">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-600 dark:text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129" />
                    </svg>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-grow flex flex-col items-center justify-center p-6">
            <!-- Screen 1: Welcome -->
            <div id="screen-1" class="screen active w-full max-w-5xl">
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-10 w-full text-center">
                    <!-- Progress indicator -->
                    <div class="welcome-progress-container mb-8">
                        <div class="welcome-progress-bar">
                            <div class="welcome-progress-fill"></div>
                        </div>
                    </div>
                    <h2 class="text-3xl font-bold text-primary dark:text-blue-400 mb-4">¡Bienvenido al Pre-triaje!</h2>
                    <p id="role-selection-instruction" class="text-gray-600 dark:text-gray-300 mb-8">Antes de continuar, por favor selecciona tu rol.</p>
                    <div class="cta-row" aria-hidden="false">
                        <button id="start-button" class="btn" aria-expanded="false" aria-controls="rolesArea">Seleccionar mi rol</button>
                    </div>
                    <div class="micro">Tiempo estimado: <strong>3–5 minutos</strong> • Tus datos son confidenciales.</div>
                    
                    <!-- Role Selection Area (initially hidden) -->
                    <div id="rolesArea" class="roles-container">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8">
                            <div class="role-card bg-white dark:bg-gray-700 rounded-xl shadow-md p-6 cursor-pointer border-2 border-transparent hover:border-primary dark:hover:border-blue-400 transition-all duration-300" id="patient-role" data-role="patient">
                                <div class="flex flex-col items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-primary dark:text-blue-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                    </svg>
                                    <h3 class="text-xl font-medium text-gray-800 dark:text-white">Paciente</h3>
                                    <p class="text-gray-500 dark:text-gray-300 text-center mt-2">Necesito atención médica</p>
                                </div>
                            </div>
                            <div class="role-card bg-white dark:bg-gray-700 rounded-xl shadow-md p-6 cursor-pointer border-2 border-transparent hover:border-primary dark:hover:border-blue-400 transition-all duration-300" id="staff-role" data-role="staff">
                                <div class="flex flex-col items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-primary dark:text-blue-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                                    </svg>
                                    <h3 class="text-xl font-medium text-gray-800 dark:text-white">Personal médico</h3>
                                    <p class="text-gray-500 dark:text-gray-300 text-center mt-2">Soy parte del equipo sanitario</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Screen 2: Basic Data -->
            <div id="screen-2" class="screen w-full max-w-5xl">
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-10 w-full">
                    <h2 class="text-2xl font-bold text-primary dark:text-blue-400 mb-6">Datos básicos</h2>
                    <form id="basic-data-form" class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="fullname" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nombre completo</label>
                                <input type="text" id="fullname" name="fullname" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-400 focus:border-primary dark:focus:border-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                            </div>
                            <div class="relative">
                                <label for="birthdate" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Fecha de nacimiento</label>
                                <input type="date" id="birthdate" name="birthdate" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-400 focus:border-primary dark:focus:border-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                                <div class="mt-2">
                                    <label for="age" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Edad</label>
                                    <input type="text" id="age" name="age" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl bg-gray-100 dark:bg-gray-600 text-gray-900 dark:text-white" readonly>
                                </div>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="docType" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo de documento</label>
                                <select id="docType" name="docType" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-400 focus:border-primary dark:focus:border-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                                    <option value="">Seleccione...</option>
                                    <option value="cc">CC</option>
                                    <option value="t.i">TI</option>
                                    <option value="passport">Pasaporte</option>
                                    <option value="other">Otro</option>
                                </select>
                            </div>
                            <div>
                                <label for="docNumber" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Número de documento</label>
                                <input type="text" id="docNumber" name="docNumber" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-400 focus:border-primary dark:focus:border-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Sexo asignado</label>
                            <div class="flex space-x-6">
                                <div class="flex items-center">
                                    <input type="radio" id="male" name="sex" value="male" class="h-5 w-5 text-primary dark:text-blue-400 focus:ring-primary dark:focus:ring-blue-400" required>
                                    <label for="male" class="ml-2 text-gray-700 dark:text-gray-300">Masculino</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="radio" id="female" name="sex" value="female" class="h-5 w-5 text-primary dark:text-blue-400 focus:ring-primary dark:focus:ring-blue-400">
                                    <label for="female" class="ml-2 text-gray-700 dark:text-gray-300">Femenino</label>
                                </div>
                            </div>
                        </div>

                        <div id="pregnancy-question" class="hidden bg-blue-50 dark:bg-blue-900/30 p-4 rounded-xl">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">¿Está embarazada?</label>
                            <div class="flex space-x-6">
                                <div class="flex items-center">
                                    <input type="radio" id="pregnant-yes" name="pregnant" value="yes" class="h-5 w-5 text-primary dark:text-blue-400 focus:ring-primary dark:focus:ring-blue-400">
                                    <label for="pregnant-yes" class="ml-2 text-gray-700 dark:text-gray-300">Sí</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="radio" id="pregnant-no" name="pregnant" value="no" class="h-5 w-5 text-primary dark:text-blue-400 focus:ring-primary dark:focus:ring-blue-400">
                                    <label for="pregnant-no" class="ml-2 text-gray-700 dark:text-gray-300">No</label>
                                </div>
                            </div>
                        </div>

                        <div id="high-risk-alert" class="hidden bg-red-50 dark:bg-red-900/30 p-4 rounded-xl border-l-4 border-red-500 dark:border-red-400">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <svg class="h-5 w-5 text-red-500 dark:text-red-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                </div>
                                <div class="ml-3">
                                    <h3 class="text-sm font-medium text-red-800 dark:text-red-300">Alto riesgo</h3>
                                    <div class="mt-1 text-sm text-red-700 dark:text-red-300">
                                        <p>Paciente mayor de 65 años. Se recomienda atención prioritaria.</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="emergency-contact-name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nombre del contacto de emergencia</label>
                                <input type="text" id="emergency-contact-name" name="emergency-contact-name" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-400 focus:border-primary dark:focus:border-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                            </div>
                            <div>
                                <label for="emergency-contact-phone" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Teléfono del contacto de emergencia</label>
                                <input type="tel" id="emergency-contact-phone" name="emergency-contact-phone" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-400 focus:border-primary dark:focus:border-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                            </div>
                            <div>
                                <label for="emergency-contact-relationship" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Parentesco del contacto de emergencia</label>
                                <input type="text" id="emergency-contact-relationship" name="emergency-contact-name" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-400 focus:border-primary dark:focus:border-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                            </div>
                        </div>

                        <div class="flex justify-end pt-4">
                            <button type="button" id="back-to-role" class="mr-4 px-6 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-blue-400 transition duration-300">
                                Atrás
                            </button>
                            <button type="submit" id="register-button" class="px-6 py-2 bg-gray-400 text-white rounded-xl cursor-not-allowed transition duration-300" disabled>
                                Registrar
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Screen 3: Medical History -->
            <div id="screen-3" class="screen w-full max-w-5xl">
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-10 w-full">
                    <h2 class="text-2xl font-bold text-primary dark:text-blue-400 mb-6">Antecedentes médicos</h2>
                    <form id="medical-history-form" class="space-y-6">
                        <div>
                            <label for="allergies" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Alergias</label>
                            
                            <!-- Hidden original select - we keep this for form submission compatibility -->
                            <select id="allergies" name="allergies" class="hidden" multiple>
                                <option value="none">Ninguna</option>
                                <option value="penicillin">Penicilina</option>
                                <option value="aspirin">Aspirina</option>
                                <option value="latex">Látex</option>
                                <option value="pollen">Polen</option>
                                <option value="food">Alimentos</option>
                                <option value="other">Otras</option>
                            </select>
                            
                            <!-- Custom dropdown with checkboxes -->
                            <div id="allergies-dropdown" class="custom-dropdown">
                                <button id="allergies-dropdown-toggle" type="button" class="dropdown-toggle">
                                    <span id="allergies-dropdown-text">Seleccione...</span>
                                    <svg class="dropdown-arrow w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                    </svg>
                                </button>
                                <div id="allergies-dropdown-menu" class="dropdown-menu">
                                    <div class="dropdown-item">
                                        <label>
                                            <input type="checkbox" id="allergy-none" value="none">
                                            <span>Ninguna</span>
                                        </label>
                                    </div>
                                    <div class="dropdown-item">
                                        <label>
                                            <input type="checkbox" id="allergy-penicillin" value="penicillin">
                                            <span>Penicilina</span>
                                        </label>
                                    </div>
                                    <div class="dropdown-item">
                                        <label>
                                            <input type="checkbox" id="allergy-aspirin" value="aspirin">
                                            <span>Aspirina</span>
                                        </label>
                                    </div>
                                    <div class="dropdown-item">
                                        <label>
                                            <input type="checkbox" id="allergy-latex" value="latex">
                                            <span>Látex</span>
                                        </label>
                                    </div>
                                    <div class="dropdown-item">
                                        <label>
                                            <input type="checkbox" id="allergy-pollen" value="pollen">
                                            <span>Polen</span>
                                        </label>
                                    </div>
                                    <div class="dropdown-item">
                                        <label>
                                            <input type="checkbox" id="allergy-food" value="food">
                                            <span>Alimentos</span>
                                        </label>
                                    </div>
                                    <div class="dropdown-item">
                                        <label>
                                            <input type="checkbox" id="allergy-other" value="other">
                                            <span>Otras</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div id="selected-allergies" class="flex flex-wrap gap-2 mt-2"></div>
                            <div id="other-allergies-container" class="hidden mt-2">
                                <label for="other-allergies" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Especificar otras alergias</label>
                                <input type="text" id="other-allergies" name="other-allergies" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-400 focus:border-primary dark:focus:border-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="Escriba aquí sus otras alergias">
                            </div>
                        </div>

                        <div>
                            <label for="conditions" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Enfermedades crónicas</label>
                            
                            <!-- Hidden original select - we keep this for form submission compatibility -->
                            <select id="conditions" name="conditions" class="hidden" multiple>
                                <option value="none">Ninguna</option>
                                <option value="hypertension">Hipertensión</option>
                                <option value="diabetes">Diabetes</option>
                                <option value="asthma">Asma</option>
                                <option value="heart-disease">Enfermedad cardíaca</option>
                                <option value="cancer">Cáncer</option>
                                <option value="other">Otras</option>
                            </select>
                            
                            <!-- Custom dropdown with checkboxes -->
                            <div id="conditions-dropdown" class="custom-dropdown">
                                <button id="conditions-dropdown-toggle" type="button" class="dropdown-toggle">
                                    <span id="conditions-dropdown-text">Seleccione...</span>
                                    <svg class="dropdown-arrow w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                    </svg>
                                </button>
                                <div id="conditions-dropdown-menu" class="dropdown-menu">
                                    <div class="dropdown-item">
                                        <label>
                                            <input type="checkbox" id="condition-none" value="none">
                                            <span>Ninguna</span>
                                        </label>
                                    </div>
                                    <div class="dropdown-item">
                                        <label>
                                            <input type="checkbox" id="condition-hypertension" value="hypertension">
                                            <span>Hipertensión</span>
                                        </label>
                                    </div>
                                    <div class="dropdown-item">
                                        <label>
                                            <input type="checkbox" id="condition-diabetes" value="diabetes">
                                            <span>Diabetes</span>
                                        </label>
                                    </div>
                                    <div class="dropdown-item">
                                        <label>
                                            <input type="checkbox" id="condition-asthma" value="asthma">
                                            <span>Asma</span>
                                        </label>
                                    </div>
                                    <div class="dropdown-item">
                                        <label>
                                            <input type="checkbox" id="condition-heart-disease" value="heart-disease">
                                            <span>Enfermedad cardíaca</span>
                                        </label>
                                    </div>
                                    <div class="dropdown-item">
                                        <label>
                                            <input type="checkbox" id="condition-cancer" value="cancer">
                                            <span>Cáncer</span>
                                        </label>
                                    </div>
                                    <div class="dropdown-item">
                                        <label>
                                            <input type="checkbox" id="condition-other" value="other">
                                            <span>Otras</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div id="selected-conditions" class="flex flex-wrap gap-2 mt-2"></div>
                            <div id="other-conditions-container" class="hidden mt-2">
                                <label for="other-conditions" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Especificar otras enfermedades crónicas</label>
                                <input type="text" id="other-conditions" name="other-conditions" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-400 focus:border-primary dark:focus:border-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="Escriba aquí otras enfermedades crónicas">
                            </div>
                        </div>

                        <div>
                            <label for="surgeries" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Cirugías previas</label>
                            <textarea id="surgeries" name="surgeries" rows="3" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-400 focus:border-primary dark:focus:border-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"></textarea>
                        </div>

                        <div class="flex justify-end pt-4">
                            <button type="button" id="back-to-basic" class="mr-4 px-6 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-blue-400 transition duration-300">
                                Atrás
                            </button>
                            <button type="submit" class="px-6 py-2 bg-primary hover:bg-blue-700 text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-blue-400 transition duration-300">
                                Continuar
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Screen 4: Main Symptoms -->
            <div id="screen-4" class="screen w-full max-w-5xl">
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-10 w-full">
                    <h2 class="text-2xl font-bold text-primary dark:text-blue-400 mb-6">Síntomas principales</h2>
                    <form id="symptoms-form" class="space-y-6">
                        <div>
                            <label for="main-symptoms" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Describa sus síntomas principales</label>
                            <textarea id="main-symptoms" name="main-symptoms" rows="5" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-400 focus:border-primary dark:focus:border-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="Describa sus síntomas con detalle (por ejemplo: dolor de pecho, dificultad para respirar, etc.)"></textarea>
                        </div>

                        <div>
                            <label for="symptoms-duration" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">¿Desde cuándo presenta estos síntomas?</label>
                            <select id="symptoms-duration" name="symptoms-duration" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-400 focus:border-primary dark:focus:border-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                <option value="">Seleccione...</option>
                                <option value="hours">Horas</option>
                                <option value="today">Hoy</option>
                                <option value="yesterday">Desde ayer</option>
                                <option value="days">Días (menos de una semana)</option>
                                <option value="weeks">Semanas</option>
                                <option value="months">Meses</option>
                            </select>
                        </div>

                        <div class="flex justify-end pt-4">
                            <button type="button" id="back-to-history" class="mr-4 px-6 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-blue-400 transition duration-300">
                                Atrás
                            </button>
                            <button type="submit" class="px-6 py-2 bg-primary hover:bg-blue-700 text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-blue-400 transition duration-300">
                                Continuar
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Screen 5: Dynamic Questionnaire -->
            <div id="screen-5" class="screen w-full max-w-5xl">
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-10 w-full">
                    <h2 class="text-2xl font-bold text-primary dark:text-blue-400 mb-6">Cuestionario específico</h2>
                    <div id="dynamic-questions" class="space-y-6">
                        <!-- Dynamic questions will be inserted here -->
                    </div>
                    <form id="dynamic-form" class="space-y-6">
                        <div class="flex justify-end pt-4">
                            <button type="button" id="back-to-symptoms" class="mr-4 px-6 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-blue-400 transition duration-300">
                                Atrás
                            </button>
                            <button type="submit" class="px-6 py-2 bg-primary hover:bg-blue-700 text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-blue-400 transition duration-300">
                                Finalizar
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Screen 6: Confirmation -->
            <div id="screen-6" class="screen w-full max-w-5xl">
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-10 w-full text-center">
                    <div class="mb-8">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-20 w-20 mx-auto text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                    <h2 class="text-3xl font-bold text-primary dark:text-blue-400 mb-4">¡Registro completado!</h2>
                    <p class="text-gray-600 dark:text-gray-300 mb-4">Sus datos han sido registrados correctamente.</p>
                    <div class="bg-blue-50 dark:bg-blue-900/30 p-4 rounded-xl mb-6">
                        <p class="text-gray-700 dark:text-gray-300">Número de referencia: <span id="reference-number" class="font-bold">PRE-12345</span></p>
                    </div>
                    <div class="bg-yellow-50 dark:bg-yellow-900/30 p-4 rounded-xl mb-8">
                        <h3 class="font-medium text-yellow-800 dark:text-yellow-300 mb-2">Recomendaciones:</h3>
                        <ul class="text-left text-yellow-700 dark:text-yellow-200 list-disc pl-5 space-y-1">
                            <li>Espere a ser llamado por el personal médico.</li>
                            <li>Si sus síntomas empeoran, notifique inmediatamente al personal.</li>
                            <li>Mantenga su mascarilla puesta en todo momento.</li>
                        </ul>
                    </div>
                    <button id="restart-button" class="bg-primary hover:bg-blue-700 text-white font-medium py-3 px-8 rounded-xl shadow-md hover:shadow-lg transition duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-blue-400">
                        Finalizar
                    </button>
                </div>
            </div>

            <!-- Screen 7: Medical Staff Panel -->
            <div id="screen-7" class="screen w-full max-w-6xl">
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-8 w-full">
                    <!-- Header Section -->
                    <div class="border-b border-gray-200 dark:border-gray-700 pb-4 mb-6">
                        <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
                            <div>
                                <h2 class="text-2xl font-bold text-blue-800 dark:text-blue-500 mb-1">Panel de Gestión de Pacientes</h2>
                                <p class="text-gray-600 dark:text-gray-400">
                                    Dr. <span id="doctor-name">Maria Muñiz</span>
                                </p>
                            </div>
                            <div class="flex items-center mt-4 md:mt-0 space-x-4">
                                <!-- User Profile Dropdown -->
                                <div class="relative" id="user-profile-container">
                                    <button id="profile-dropdown-btn" class="flex items-center space-x-2 bg-blue-50 dark:bg-blue-900/30 py-2 px-3 rounded-xl hover:bg-blue-100 dark:hover:bg-blue-800/50 transition-colors">
                                        <div class="w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white overflow-hidden" id="user-avatar">
                                            <span id="user-initials">MM</span>
                                        </div>
                                        <div class="text-left hidden md:block">
                                            <p class="text-sm font-medium text-blue-800 dark:text-blue-400" id="dropdown-user-name">Maria Muñiz</p>
                                            <p class="text-xs text-blue-600 dark:text-blue-300" id="dropdown-user-role">Médico</p>
                                        </div>
                                        <svg class="w-4 h-4 text-blue-800 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                        </svg>
                                    </button>
                                    
                                    <div id="profile-dropdown-menu" class="hidden absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-xl shadow-lg py-1 z-50 border border-gray-200 dark:border-gray-700">
                                        <a href="#" id="view-profile-btn" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                                            <svg class="inline-block w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                            </svg>
                                            Mi Perfil
                                        </a>
                                        <a href="#" id="settings-btn" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                                            <svg class="inline-block w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                            </svg>
                                            Configuración
                                        </a>
                                        <a href="#" id="export-csv-btn" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                                            <svg class="inline-block w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                                            </svg>
                                            Exportar CSV
                                        </a>
                                        <div class="border-t border-gray-200 dark:border-gray-700"></div>
                                        <a href="#" id="logout-btn" class="block px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700">
                                            <svg class="inline-block w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                                            </svg>
                                            Cerrar Sesión
                                        </a>
                                    </div>
                                </div>

                                <div class="bg-blue-50 dark:bg-blue-900/30 p-3 rounded-xl">
                                    <div id="current-datetime" class="text-blue-800 dark:text-blue-400 font-medium"></div>
                                </div>

                                <!-- Real-time status indicator -->
                                <div id="connection-status" class="hidden md:flex items-center space-x-1 bg-green-100 dark:bg-green-900/30 px-3 py-1.5 rounded-xl">
                                    <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                                    <span class="text-xs font-medium text-green-800 dark:text-green-400">En línea</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Filters and Controls -->
                    <div class="flex flex-wrap gap-4 mb-6 items-center">
                        <div class="w-full md:w-auto">
                            <label for="esi-filter" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Filtrar por ESI</label>
                            <select id="esi-filter" class="w-full md:w-40 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-blue-700 dark:focus:ring-blue-500 focus:border-blue-700 dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                <option value="all">Todos</option>
                                <option value="1">ESI 1</option>
                                <option value="2">ESI 2</option>
                                <option value="3">ESI 3</option>
                                <option value="4">ESI 4</option>
                                <option value="5">ESI 5</option>
                            </select>
                        </div>

                        <div class="w-full md:w-auto">
                            <label for="sort-by" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Ordenar por</label>
                            <select id="sort-by" class="w-full md:w-48 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-blue-700 dark:focus:ring-blue-500 focus:border-blue-700 dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                <option value="arrival">Hora de llegada</option>
                                <option value="name">Nombre</option>
                                <option value="esi">Nivel ESI</option>
                            </select>
                        </div>

                        <div class="w-full md:w-auto md:ml-auto">
                            <label for="status-filter" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Estado</label>
                            <select id="status-filter" class="w-full md:w-40 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-blue-700 dark:focus:ring-blue-500 focus:border-blue-700 dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                <option value="all">Todos</option>
                                <option value="waiting">En espera</option>
                                <option value="in-progress">En atención</option>
                                <option value="completed">Atendido</option>
                            </select>
                        </div>
                        
                        <div class="w-full md:w-auto">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Exportar datos</label>
                            <div class="flex space-x-2">
                                <button id="export-csv-button" class="flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-800 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-700 dark:focus:ring-blue-500 transition duration-300">
                                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                                    </svg>
                                    CSV
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Waiting List Table -->
                    <div class="overflow-x-auto rounded-xl">
                        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                            <thead class="bg-gray-50 dark:bg-gray-700">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ESI</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Paciente</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ID</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Edad/Sexo</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Llegada</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Motivo</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Estado</th>
                                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Acciones</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700" id="patient-list">
                                <!-- Example patient rows - Will be populated dynamically -->
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-blue-500" title="ESI 5 - No Urgente">
                                            <span class="text-white font-bold text-xs">5</span>
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm font-medium text-gray-900 dark:text-white">Laura Gómez</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">PRE-52506</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">28/F</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">09:15</div>
                                    </td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm text-gray-900 dark:text-white">Dolor de garganta leve</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200">
                                            En espera
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                                        <button class="text-blue-700 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 mr-3 view-history-btn" data-patient-id="PRE-56789" data-esi-level="5">
                                            Ver historial
                                        </button>
                                        <button class="text-green-700 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300 start-evaluation-btn" data-patient-id="PRE-56789">
                                            Iniciar
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-green-500" title="ESI 4 - Menor Urgencia">
                                            <span class="text-white font-bold text-xs">4</span>
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm font-medium text-gray-900 dark:text-white">Juan Pérez</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">PRE-45678</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">42/M</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">09:45</div>
                                    </td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm text-gray-900 dark:text-white">Dolor de oído</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200">
                                            En espera
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                                        <button class="text-blue-700 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 mr-3 view-history-btn" data-patient-id="PRE-45678" data-esi-level="4">
                                            Ver historial
                                        </button>
                                        <button class="text-green-700 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300 start-evaluation-btn" data-patient-id="PRE-45678">
                                            Iniciar
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-red-600" title="ESI 1 - Resucitación">
                                            <span class="text-white font-bold text-xs">1</span>
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm font-medium text-gray-900 dark:text-white">Carlos Rodríguez</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">PRE-12345</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">72/M</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">10:15</div>
                                    </td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm text-gray-900 dark:text-white">Dolor de pecho intenso</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200">
                                            En espera
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                                        <button class="text-blue-700 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 mr-3 view-history-btn" data-patient-id="PRE-12345" data-esi-level="1">
                                            Ver historial
                                        </button>
                                        <button class="text-green-700 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300 start-evaluation-btn" data-patient-id="PRE-12345">
                                            Iniciar
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-yellow-400" title="ESI 3 - Urgencia">
                                            <span class="text-white font-bold text-xs">3</span>
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm font-medium text-gray-900 dark:text-white">Miguel López</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">PRE-34567</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">35/M</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">11:00</div>
                                    </td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm text-gray-900 dark:text-white">Dolor abdominal moderado</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200">
                                            En espera
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                                        <button class="text-blue-700 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 mr-3 view-history-btn" data-patient-id="PRE-34567" data-esi-level="3">
                                            Ver historial
                                        </button>
                                        <button class="text-green-700 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300 start-evaluation-btn" data-patient-id="PRE-34567">
                                            Iniciar
                                        </button>
                                    </td>
                                </tr>
                                <!-- Additional patient examples -->
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-orange-500" title="ESI 2 - Emergencia">
                                            <span class="text-white font-bold text-xs">2</span>
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm font-medium text-gray-900 dark:text-white">Elena Ramírez</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">PRE-23456</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">67/F</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">08:30</div>
                                    </td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm text-gray-900 dark:text-white">Dificultad para respirar severa</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200">
                                            En espera
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                                        <button class="text-blue-700 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 mr-3 view-history-btn" data-patient-id="PRE-23456" data-esi-level="2">
                                            Ver historial
                                        </button>
                                        <button class="text-green-700 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300 start-evaluation-btn" data-patient-id="PRE-23456">
                                            Iniciar
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-yellow-400" title="ESI 3 - Urgencia">
                                            <span class="text-white font-bold text-xs">3</span>
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm font-medium text-gray-900 dark:text-white">Fernando Torres</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">PRE-78901</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">52/M</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">10:45</div>
                                    </td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm text-gray-900 dark:text-white">Fiebre alta persistente</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">
                                            En atención
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                                        <button class="text-blue-700 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 mr-3 view-history-btn" data-patient-id="PRE-78901" data-esi-level="3">
                                            Ver historial
                                        </button>
                                        <button class="text-green-700 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300 start-evaluation-btn" data-patient-id="PRE-78901">
                                            Iniciar
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-green-500" title="ESI 4 - Menor Urgencia">
                                            <span class="text-white font-bold text-xs">4</span>
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm font-medium text-gray-900 dark:text-white">Patricia Sánchez</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">PRE-89012</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">31/F</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">11:30</div>
                                    </td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm text-gray-900 dark:text-white">Infección ocular</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200">
                                            Atendido
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                                        <button class="text-blue-700 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 mr-3 view-history-btn" data-patient-id="PRE-89012" data-esi-level="4">
                                            Ver historial
                                        </button>
                                        <button class="text-green-700 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300 start-evaluation-btn" data-patient-id="PRE-89012">
                                            Iniciar
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-blue-500" title="ESI 5 - No Urgente">
                                            <span class="text-white font-bold text-xs">5</span>
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm font-medium text-gray-900 dark:text-white">Roberto Martín</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">PRE-90123</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">24/M</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">13:15</div>
                                    </td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm text-gray-900 dark:text-white">Resfriado común</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200">
                                            En espera
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                                        <button class="text-blue-700 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 mr-3 view-history-btn" data-patient-id="PRE-90123" data-esi-level="5">
                                            Ver historial
                                        </button>
                                        <button class="text-green-700 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300 start-evaluation-btn" data-patient-id="PRE-90123">
                                            Iniciar
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-red-600" title="ESI 1 - Resucitación">
                                            <span class="text-white font-bold text-xs">1</span>
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm font-medium text-gray-900 dark:text-white">Alejandro Vargas</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">PRE-67890</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">58/M</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">09:05</div>
                                    </td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm text-gray-900 dark:text-white">Posible ACV</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">
                                            En atención
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                                        <button class="text-blue-700 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 mr-3 view-history-btn" data-patient-id="PRE-67890" data-esi-level="1">
                                            Ver historial
                                        </button>
                                        <button class="text-green-700 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300 start-evaluation-btn" data-patient-id="PRE-67890">
                                            Iniciar
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-orange-500" title="ESI 2 - Emergencia">
                                            <span class="text-white font-bold text-xs">2</span>
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm font-medium text-gray-900 dark:text-white">Lucía Hernández</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">PRE-54321</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">39/F</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500 dark:text-gray-400">12:10</div>
                                    </td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm text-gray-900 dark:text-white">Reacción alérgica grave</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200">
                                            Atendido
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                                        <button class="text-blue-700 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 mr-3 view-history-btn" data-patient-id="PRE-54321" data-esi-level="2">
                                            Ver historial
                                        </button>
                                        <button class="text-green-700 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300 start-evaluation-btn" data-patient-id="PRE-54321">
                                            Iniciar
                                        </button>
                                    </td>
                                </tr>
                                <!-- End of additional patients -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Return to Role Selection Button -->
                    <div class="flex justify-end mt-6">
                        <button id="back-to-role-staff" class="px-6 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-700 dark:focus:ring-blue-500 transition duration-300">
                            Salir
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Patient History Modal -->
            <div id="history-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black bg-opacity-50">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="p-6">
                        <div class="flex justify-between items-center border-b border-gray-200 dark:border-gray-700 pb-4 mb-4">
                            <h3 class="text-xl font-bold text-gray-900 dark:text-white">Historial del Paciente</h3>
                            <button id="close-history-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                        
                        <div class="mb-4 bg-blue-50 dark:bg-blue-900/30 p-4 rounded-xl">
                            <h4 class="text-lg font-medium text-blue-800 dark:text-blue-400 mb-2">Datos del paciente</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <p class="text-sm text-gray-700 dark:text-gray-300"><span class="font-medium">Nombre:</span> <span id="modal-patient-name">Ana Martínez</span></p>
                                    <p class="text-sm text-gray-700 dark:text-gray-300"><span class="font-medium">ID:</span> <span id="modal-patient-id">PRE-23456</span></p>
                                    <p class="text-sm text-gray-700 dark:text-gray-300"><span class="font-medium">Edad:</span> <span id="modal-patient-age">45</span></p>
                                    <p class="text-sm text-gray-700 dark:text-gray-300"><span class="font-medium">Sexo:</span> <span id="modal-patient-sex">Femenino</span></p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-700 dark:text-gray-300"><span class="font-medium">Alergias:</span> <span id="modal-patient-allergies">Penicilina</span></p>
                                    <p class="text-sm text-gray-700 dark:text-gray-300"><span class="font-medium">Condiciones:</span> <span id="modal-patient-conditions">Asma</span></p>
                                    <p class="text-sm text-gray-700 dark:text-gray-300"><span class="font-medium">Contacto:</span> <span id="modal-emergency-contact">María Gómez (Hermana) - 555-1234</span></p>
                                </div>
                            </div>
                        </div>
                        
                        <div id="modal-alert" class="mb-4 bg-red-50 dark:bg-red-900/30 p-4 rounded-xl border-l-4 border-red-500 dark:border-red-400">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <svg class="h-5 w-5 text-red-500 dark:text-red-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                </div>
                                <div class="ml-3">
                                    <h3 class="text-sm font-medium text-red-800 dark:text-red-300">Alerta médica</h3>
                                    <div class="mt-1 text-sm text-red-700 dark:text-red-300">
                                        <p id="modal-alert-text">Paciente con asma severa. Historial de ataques que requirieron hospitalización.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <h4 class="text-lg font-medium text-gray-800 dark:text-gray-200 mb-2">Atenciones previas</h4>
                            <div class="bg-white dark:bg-gray-700 shadow overflow-hidden rounded-lg">
                                <ul id="modal-previous-visits" class="divide-y divide-gray-200 dark:divide-gray-600">
                                    <li class="p-4">
                                        <div class="flex justify-between">
                                            <div>
                                                <p class="font-medium text-gray-800 dark:text-white">15 marzo 2025</p>
                                                <p class="text-sm text-gray-600 dark:text-gray-300">Crisis asmática</p>
                                            </div>
                                            <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-yellow-400" title="ESI 3 - Urgencia">
                                                <span class="text-white font-bold text-xs">3</span>
                                            </span>
                                        </div>
                                    </li>
                                    <li class="p-4">
                                        <div class="flex justify-between">
                                            <div>
                                                <p class="font-medium text-gray-800 dark:text-white">2 enero 2025</p>
                                                <p class="text-sm text-gray-600 dark:text-gray-300">Neumonía</p>
                                            </div>
                                            <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-orange-500" title="ESI 2 - Emergencia">
                                                <span class="text-white font-bold text-xs">2</span>
                                            </span>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Vital Signs Modal -->
            <div id="vital-signs-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black bg-opacity-50">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg max-w-2xl w-full">
                    <div class="p-6">
                        <div class="flex justify-between items-center border-b border-gray-200 dark:border-gray-700 pb-4 mb-4">
                            <h3 class="text-xl font-bold text-gray-900 dark:text-white">Evaluación del Paciente</h3>
                            <button id="close-vital-signs-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                        
                        <div class="mb-4 bg-blue-50 dark:bg-blue-900/30 p-4 rounded-xl">
                            <p class="text-sm text-gray-700 dark:text-gray-300"><span class="font-medium">Paciente:</span> <span id="vital-signs-patient-name">Ana Martínez</span></p>
                            <p class="text-sm text-gray-700 dark:text-gray-300"><span class="font-medium">Motivo consulta:</span> <span id="vital-signs-reason">Dificultad para respirar severa</span></p>
                        </div>
                        
                        <form id="vital-signs-form" class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label for="temperature" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Temperatura (°C)</label>
                                    <input type="number" step="0.1" id="temperature" name="temperature" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-blue-700 dark:focus:ring-blue-500 focus:border-blue-700 dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="36.5" required>
                                </div>
                                <div>
                                    <label for="blood-pressure" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Presión arterial (mmHg)</label>
                                    <input type="text" id="blood-pressure" name="blood-pressure" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-blue-700 dark:focus:ring-blue-500 focus:border-blue-700 dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="120/80" required pattern="[0-9]{2,3}\/[0-9]{2,3}">
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label for="heart-rate" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Frecuencia cardiaca</label>
                                    <input type="number" id="heart-rate" name="heart-rate" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-blue-700 dark:focus:ring-blue-500 focus:border-blue-700 dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="80" required>
                                </div>
                                <div>
                                    <label for="respiratory-rate" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Frecuencia respiratoria</label>
                                    <input type="number" id="respiratory-rate" name="respiratory-rate" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-blue-700 dark:focus:ring-blue-500 focus:border-blue-700 dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="16" required>
                                </div>
                                <div>
                                    <label for="oxygen-saturation" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Saturación O₂ (%)</label>
                                    <input type="number" id="oxygen-saturation" name="oxygen-saturation" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-blue-700 dark:focus:ring-blue-500 focus:border-blue-700 dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="98" required min="1" max="100">
                                </div>
                            </div>
                            
                            <div>
                                <label for="esi-level" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nivel ESI</label>
                                <div class="grid grid-cols-5 gap-2">
                                    <button type="button" class="esi-btn px-4 py-2 bg-red-600 text-white rounded-xl hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500" data-esi="1">ESI 1</button>
                                    <button type="button" class="esi-btn px-4 py-2 bg-orange-500 text-white rounded-xl hover:bg-orange-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500" data-esi="2">ESI 2</button>
                                    <button type="button" class="esi-btn px-4 py-2 bg-yellow-400 text-white rounded-xl hover:bg-yellow-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500" data-esi="3">ESI 3</button>
                                    <button type="button" class="esi-btn px-4 py-2 bg-green-500 text-white rounded-xl hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500" data-esi="4">ESI 4</button>
                                    <button type="button" class="esi-btn px-4 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" data-esi="5">ESI 5</button>
                                </div>
                                <input type="hidden" id="selected-esi" name="selected-esi" required>
                            </div>
                            
                            <div>
                                <label for="observations" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Observaciones</label>
                                <textarea id="observations" name="observations" rows="3" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-blue-700 dark:focus:ring-blue-500 focus:border-blue-700 dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"></textarea>
                            </div>
                            
                            <div class="flex justify-end pt-4 space-x-4">
                                <button type="button" id="generate-report-btn" class="px-6 py-2 bg-blue-700 hover:bg-blue-800 text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-700 transition duration-300">
                                    Generar reporte
                                </button>
                                <button type="submit" class="px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-600 transition duration-300">
                                    Confirmar ESI
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Login Modal -->
            <div id="login-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black bg-opacity-50">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg max-w-md w-full p-6">
                    <div class="flex justify-between items-center border-b border-gray-200 dark:border-gray-700 pb-3 mb-4">
                        <h3 class="text-xl font-bold text-gray-900 dark:text-white">Iniciar Sesión</h3>
                        <button id="close-login-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <form id="login-form" class="space-y-4">
                        <div>
                            <label for="login-email" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Correo Electrónico</label>
                            <input type="email" id="login-email" name="email" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-500 focus:border-primary dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                        </div>
                        <div>
                            <label for="login-password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Contraseña</label>
                            <input type="password" id="login-password" name="password" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-500 focus:border-primary dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <input id="remember-me" name="remember-me" type="checkbox" class="h-4 w-4 text-primary dark:text-blue-500 focus:ring-primary dark:focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded">
                                <label for="remember-me" class="ml-2 block text-sm text-gray-700 dark:text-gray-300">
                                    Recordarme
                                </label>
                            </div>
                            <button type="button" id="forgot-password-btn" class="text-sm font-medium text-primary dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300">
                                ¿Olvidó su contraseña?
                            </button>
                        </div>
                        
                        <div>
                            <button type="submit" class="w-full bg-primary hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-xl focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-blue-500 transition duration-300">
                                Ingresar
                            </button>
                        </div>
                        
                        <div class="text-center">
                            <span class="text-sm text-gray-600 dark:text-gray-400">¿No tiene una cuenta? </span>
                            <button type="button" id="show-register-btn" class="text-sm font-medium text-primary dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300">
                                Registrarse
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Registration Modal -->
            <div id="register-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black bg-opacity-50">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg max-w-md w-full p-6">
                    <div class="flex justify-between items-center border-b border-gray-200 dark:border-gray-700 pb-3 mb-4">
                        <h3 class="text-xl font-bold text-gray-900 dark:text-white">Crear Cuenta</h3>
                        <button id="close-register-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <form id="register-form" class="space-y-4">
                        <div>
                            <label for="register-fullname" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nombre Completo</label>
                            <input type="text" id="register-fullname" name="fullname" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-500 focus:border-primary dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                        </div>
                        <div>
                            <label for="register-email" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Correo Electrónico</label>
                            <input type="email" id="register-email" name="email" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-500 focus:border-primary dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                        </div>
                        <div>
                            <label for="register-password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Contraseña</label>
                            <input type="password" id="register-password" name="password" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-500 focus:border-primary dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                        </div>
                        <div>
                            <label for="register-confirm-password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Confirmar Contraseña</label>
                            <input type="password" id="register-confirm-password" name="confirm-password" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-500 focus:border-primary dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                        </div>
                        <div>
                            <label for="register-role" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Rol</label>
                            <select id="register-role" name="role" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-500 focus:border-primary dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                <option value="doctor">Médico</option>
                                <option value="nurse">Enfermero/a</option>
                                <option value="admin">Administrador</option>
                            </select>
                        </div>
                        <div>
                            <button type="submit" class="w-full bg-primary hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-xl focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-blue-500 transition duration-300">
                                Registrarse
                            </button>
                        </div>
                        
                        <div class="text-center">
                            <span class="text-sm text-gray-600 dark:text-gray-400">¿Ya tiene una cuenta? </span>
                            <button type="button" id="show-login-btn" class="text-sm font-medium text-primary dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300">
                                Iniciar Sesión
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Password Recovery Modal -->
            <div id="password-recovery-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black bg-opacity-50">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg max-w-md w-full p-6">
                    <div class="flex justify-between items-center border-b border-gray-200 dark:border-gray-700 pb-3 mb-4">
                        <h3 class="text-xl font-bold text-gray-900 dark:text-white">Recuperar Contraseña</h3>
                        <button id="close-password-recovery-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <div id="recovery-step-1">
                        <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">
                            Por favor, ingrese su correo electrónico y le enviaremos un enlace para restablecer su contraseña.
                        </p>
                        
                        <form id="password-recovery-form" class="space-y-4">
                            <div>
                                <label for="recovery-email" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Correo Electrónico</label>
                                <input type="email" id="recovery-email" name="email" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-500 focus:border-primary dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                            </div>
                            
                            <div>
                                <button type="submit" class="w-full bg-primary hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-xl focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-blue-500 transition duration-300">
                                    Enviar Enlace de Recuperación
                                </button>
                            </div>
                            
                            <div class="text-center">
                                <button type="button" id="back-to-login-btn" class="text-sm font-medium text-primary dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300">
                                    Volver a Iniciar Sesión
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <div id="recovery-step-2" class="hidden">
                        <div class="text-center mb-6">
                            <svg class="mx-auto h-12 w-12 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <h3 class="mt-2 text-lg font-medium text-gray-900 dark:text-white">¡Correo enviado!</h3>
                            <p class="mt-1 text-sm text-gray-600 dark:text-gray-400">
                                Hemos enviado un enlace de recuperación a su correo. Por favor, revise su bandeja de entrada.
                            </p>
                        </div>
                        
                        <div class="text-center">
                            <button type="button" id="recovery-done-btn" class="w-full bg-primary hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-xl focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-blue-500 transition duration-300">
                                Entendido
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Profile Management Modal -->
            <div id="profile-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black bg-opacity-50">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="p-6">
                        <div class="flex justify-between items-center border-b border-gray-200 dark:border-gray-700 pb-3 mb-4">
                            <h3 class="text-xl font-bold text-gray-900 dark:text-white">Mi Perfil</h3>
                            <button id="close-profile-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                        
                        <div class="flex flex-col md:flex-row gap-6">
                            <div class="md:w-1/3 flex flex-col items-center">
                                <div class="w-32 h-32 rounded-full bg-blue-500 flex items-center justify-center text-white text-3xl overflow-hidden mb-4" id="profile-avatar">
                                    <span id="profile-initials">MM</span>
                                </div>
                                <button id="change-avatar-btn" class="text-sm font-medium text-primary dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300">
                                    Cambiar Avatar
                                </button>
                                <input type="file" id="avatar-upload" class="hidden" accept="image/*">
                            </div>
                            
                            <div class="md:w-2/3">
                                <form id="profile-form" class="space-y-4">
                                    <div>
                                        <label for="profile-fullname" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nombre Completo</label>
                                        <input type="text" id="profile-fullname" name="fullname" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-500 focus:border-primary dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                                    </div>
                                    <div>
                                        <label for="profile-email" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Correo Electrónico</label>
                                        <input type="email" id="profile-email" name="email" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-500 focus:border-primary dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                                    </div>
                                    <div>
                                        <label for="profile-speciality" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Especialidad</label>
                                        <input type="text" id="profile-speciality" name="speciality" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-500 focus:border-primary dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                    </div>
                                    <div>
                                        <button type="submit" class="w-full bg-primary hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-xl focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-blue-500 transition duration-300">
                                            Guardar Cambios
                                        </button>
                                    </div>
                                </form>
                                
                                <div class="border-t border-gray-200 dark:border-gray-700 my-4 pt-4">
                                    <h4 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Cambiar Contraseña</h4>
                                    <form id="change-password-form" class="space-y-4">
                                        <div>
                                            <label for="current-password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Contraseña Actual</label>
                                            <input type="password" id="current-password" name="current-password" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-500 focus:border-primary dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                                        </div>
                                        <div>
                                            <label for="new-password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nueva Contraseña</label>
                                            <input type="password" id="new-password" name="new-password" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-500 focus:border-primary dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                                        </div>
                                        <div>
                                            <label for="confirm-new-password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Confirmar Nueva Contraseña</label>
                                            <input type="password" id="confirm-new-password" name="confirm-new-password" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-primary dark:focus:ring-blue-500 focus:border-primary dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" required>
                                        </div>
                                        <div>
                                            <button type="submit" class="w-full bg-primary hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-xl focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-blue-500 transition duration-300">
                                                Actualizar Contraseña
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Language Selection Modal -->
            <div id="language-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black bg-opacity-50">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg max-w-md w-full p-6">
                    <div class="flex justify-between items-center border-b border-gray-200 dark:border-gray-700 pb-3 mb-4">
                        <h3 class="text-xl font-bold text-gray-900 dark:text-white">Seleccionar Idioma</h3>
                        <button id="close-language-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="space-y-2">
                        <button class="language-option w-full flex items-center px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200" data-lang="es">
                            <span class="fi fi-es mr-3"></span>
                            <div class="flex-grow text-left">
                                <div class="font-medium text-gray-900 dark:text-white">Español</div>
                                <div class="text-sm text-gray-500 dark:text-gray-400">Spanish</div>
                            </div>
                            <svg class="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                        </button>
                        
                        <button class="language-option w-full flex items-center px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200" data-lang="en">
                            <span class="fi fi-us mr-3"></span>
                            <div class="flex-grow text-left">
                                <div class="font-medium text-gray-900 dark:text-white">English</div>
                                <div class="text-sm text-gray-500 dark:text-gray-400">Inglés</div>
                            </div>
                        </button>
                        
                        <button class="language-option w-full flex items-center px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200" data-lang="pt">
                            <span class="fi fi-br mr-3"></span>
                            <div class="flex-grow text-left">
                                <div class="font-medium text-gray-900 dark:text-white">Português</div>
                                <div class="text-sm text-gray-500 dark:text-gray-400">Portugués</div>
                            </div>
                        </button>
                        
                        <button class="language-option w-full flex items-center px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200" data-lang="fr">
                            <span class="fi fi-fr mr-3"></span>
                            <div class="flex-grow text-left">
                                <div class="font-medium text-gray-900 dark:text-white">Français</div>
                                <div class="text-sm text-gray-500 dark:text-gray-400">Francés</div>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Unsaved Changes Alert -->
            <div id="unsaved-changes-alert" class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black bg-opacity-50">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg max-w-md w-full p-6">
                    <div class="flex items-center mb-4 text-yellow-500">
                        <svg class="w-8 h-8 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                        </svg>
                        <h3 class="text-lg font-medium text-gray-900 dark:text-white">Cambios sin guardar</h3>
                    </div>
                    
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">
                        Tiene cambios sin guardar. ¿Está seguro de que desea abandonar la página?
                    </p>
                    
                    <div class="flex space-x-3 justify-end">
                        <button id="stay-btn" class="px-4 py-2 bg-white hover:bg-gray-100 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 rounded-xl focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500">
                            Permanecer
                        </button>
                        <button id="leave-btn" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500">
                            Abandonar
                        </button>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-white dark:bg-gray-800 py-4 px-6 shadow-inner">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <p class="text-gray-600 dark:text-gray-400 text-sm mb-2 md:mb-0">© 2025 Sistema de Pre-Triaje. Todos los derechos reservados.</p>
                <div class="flex space-x-4">
                    <button class="text-gray-600 dark:text-gray-400 text-sm hover:text-primary dark:hover:text-blue-400 transition duration-300">Términos y condiciones</button>
                    <button class="text-gray-600 dark:text-gray-400 text-sm hover:text-primary dark:hover:text-blue-400 transition duration-300">Política de privacidad</button>
                    <button class="text-gray-600 dark:text-gray-400 text-sm hover:text-primary dark:hover:text-blue-400 transition duration-300">Ayuda</button>
                </div>
            </div>
        </footer>
    </div>
    <script src="scripts.js"></script>
</html>